# Malware Incident Playbook (Quick Reference)

**Use when a malware alert is detected.**

## Step 0 — Initial Triage
- Who: Any user/IT staff who first sees the issue
- Action:
  - Note affected host name, user, and timestamp.
  - Capture a screenshot of the alert or ransom note.
  - Do NOT reboot (unless instructed) — collect volatile data first.

## Step 1 — Identification (10–20 min)
- Query AV/EDR for alert and IOC (hash, domains, C2 IPs).
- Check nearby logs (Windows Event Viewer, /var/log/syslog).
- Check network flows (NetFlow, firewall logs) for unusual connections.

## Step 2 — Isolation (immediate)
- Isolate the host:
  - Unplug network cable or disable NIC
  - If remote, disable user account or block MAC/IP in switch
- Inform Incident Response Lead.

## Step 3 — Evidence Collection (see checklist)
- On Windows:
  - `tasklist /v`, `netstat -ano`, `wmic process get Caption,ProcessId,CommandLine`
  - Dump memory if needed (using trusted tools)
- On Linux:
  - `ps aux`, `ss -tunap`, `lsof -i`, `dmesg`
- Copy AV logs, system logs, and take a forensic image if required.

## Step 4 — Eradication
- If malware limited to files/processes:
  - Quarantine and remove via AV/EDR
  - Delete or isolate malicious files
- If system compromised or evidence of persistence:
  - Reimage system from known-good image
  - Reset user credentials
  - Revoke any exposed keys/secrets

## Step 5 — Recovery
- Restore from clean backup
- Reintroduce to network with monitoring
- Continue EDR watch for at least 7 days

## Step 6 — Reporting & Lessons
- Document timeline, artifacts, root cause
- Update indicators of compromise (IOCs) in blocklists
- Conduct a lessons-learned meeting

## Quick commands (examples)
- Windows: `wevtutil qe System /f:text /c:100`
- Linux: `sudo journalctl -u ssh -S -1h` (last 1 hour)
- Network: `sudo tcpdump -nni any host <suspicious-ip> -w capture.pcap`
